---
title: 'Next学習'
date: '2020-01-02'
---


Next.js

プレレンダリングの仕組み

Nextはデフォルトで全ページをPre-renderする
Pre-renderとは事前にHTMLを生成すること。
JSXでコンポーネントを書いていくが、それ自体は直接ユーザーに見せている部分ではなくて、最終的にコンパイルされて、HTML、JS、CSSファイルになりユーザーに見せている。
このコンパイル作業は通常ブラウザで行われているが、これを別の場所の場所で行ってHTMLを生成してからユーザーに見せるというのがPre-renderの仕組み。
それ故に、ブラウザの負荷を下げて、表示を高速化することができる。
検索エンジンのクローラーにコンテンツを見せることができるのでSEO的にも効果的である。

プレレンダリングで前もってHTMLが生成しているので、ChromeのDevツールでJavaScriptをオフにしても表示できる。
react-create-appでつくったものはしていない（ブラウザでHTMLを組み立てる）ので表示できなくなる


プレレンダリングの中にも二種類存在する
・静的生成
→アプリケーションがbuildした時点でHTMLが組み立てられ、表示している
→表示も早い

・サーバーサイドレンダリング
→ユーザーがリクエストを投げた時にHTMLを組み立てて表示している
→常に最新の状態のものをユーザーに届けることができる

この二つの使い分け
→ページ毎に特徴に応じてどっちの方式を採用するか選択できる。

・静的生成
→基本的には静的生成することが推奨されている
→キャッシュが効くので、表示スピードが早いので
→更新頻度が低いページ　ユーザー：コンテンツ = 1:N

・サーバーサイドレンダリング
→更新頻度が高いページ　ユーザー：コンテンツ = N:N


静的ジェネレーション
外部データ無し
→ビルド時にHTMLをレンダリング


外部データあり
→ビルド時にDBや外部APIからデータを取得（getStaticProps()を使う）
→取得したデータを使ってHTMLをレンダリング

getStaticPropsでデータを取得
・外部データを取得するために使う
・async/awaitを使って非同期処理を制御できる
・本番環境ではビルド時に実行される関数
・開発環境ではリクエスト毎に実行する
・pageコンポーネントでのみ使用可能


